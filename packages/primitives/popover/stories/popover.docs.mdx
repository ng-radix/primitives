import { ArgTypes, Canvas, Markdown, Meta } from '@storybook/blocks';
import * as PopoverStories from "./popover.stories";
import {RdxPopoverRootDirective} from "../src/popover-root.directive";
import {RdxPopoverContentDirective} from "../src/popover-content.directive";
import {RdxPopoverArrowDirective} from "../src/popover-arrow.directive";
import {RdxPopoverCloseDirective} from "../src/popover-close.directive";

<Meta title="Primitives/Popover" />

# Popover

#### A popup that displays information related to an element when the element receives keyboard focus or the mouse hovers over it.

## Examples
### Default

<Canvas sourceState="hidden" of={PopoverStories.Default} />

### Multiple

<Canvas sourceState="hidden" of={PopoverStories.Multiple} />

### Events

<Canvas sourceState="hidden" of={PopoverStories.Events} />

### Positioning

<Canvas sourceState="hidden" of={PopoverStories.Positioning} />

### External Triggering

<Canvas sourceState="hidden" of={PopoverStories.ExternalTriggering} />

### Animations

<Canvas sourceState="hidden" of={PopoverStories.Animations} />

#### Custom Animation Styles

```css
/* Open animations */

.rdx-custom-animated-content {
    &:is(.rdx-custom-animated-content-open, .rdx-custom-animated-content-close) {
        animation-duration: 400ms;
        animation-timing-function: cubic-bezier(0.16, 1, 0.3, 1);
        will-change: transform, opacity;
    }

    &.rdx-custom-animated-content-open {
        &[data-state='open'][data-side='top'] {
            animation-name: rdxCustomSlideDownAndFade;
        }

        &[data-state='open'][data-side='right'] {
            animation-name: rdxCustomSlideLeftAndFade;
        }

        &[data-state='open'][data-side='bottom'] {
            animation-name: rdxCustomSlideUpAndFade;
        }

        &[data-state='open'][data-side='left'] {
            animation-name: rdxCustomSlideRightAndFade;
        }
    }

    &.rdx-custom-animated-content-close {
        &[data-state='closed'][data-side='top'] {
            animation-name: rdxCustomSlideDownAndFadeReverse;
        }

        &[data-state='closed'][data-side='right'] {
            animation-name: rdxCustomSlideLeftAndFadeReverse;
        }

        &[data-state='closed'][data-side='bottom'] {
            animation-name: rdxCustomSlideUpAndFadeReverse;
        }

        &[data-state='closed'][data-side='left'] {
            animation-name: rdxCustomSlideRightAndFadeReverse;
        }
    }
}

@keyframes rdxCustomSlideUpAndFade {
    from {
        opacity: 0;
        transform: translateY(2px);
        /*transition:left 1s linear;*/
    }
    to {
        opacity: 1;
        transform: translateY(0);
    }
}

@keyframes rdxCustomSlideRightAndFade {
    from {
        opacity: 0;
        transform: translateX(-2px);
    }
    to {
        opacity: 1;
        transform: translateX(0);
    }
}

@keyframes rdxCustomSlideDownAndFade {
    from {
        opacity: 0;
        transform: translateY(-2px);
    }
    to {
        opacity: 1;
        transform: translateY(0);
    }
}

@keyframes rdxCustomSlideLeftAndFade {
    from {
        opacity: 0;
        transform: translateX(2px);
    }
    to {
        opacity: 1;
        transform: translateX(0);
    }
}

/* Close animations */

@keyframes rdxCustomSlideUpAndFadeReverse {
    from {
        opacity: 1;
        transform: translateY(0);
    }
    to {
        opacity: 0;
        transform: translateY(2px);
    }
}

@keyframes rdxCustomSlideRightAndFadeReverse {
    from {
        opacity: 1;
        transform: translateX(0);
    }
    to {
        opacity: 0;
        transform: translateX(-2px);
    }
}

@keyframes rdxCustomSlideDownAndFadeReverse {
    from {
        opacity: 1;
        transform: translateY(0);
    }
    to {
        opacity: 0;
        transform: translateY(-2px);
    }
}

@keyframes rdxCustomSlideLeftAndFadeReverse {
    from {
        opacity: 1;
        transform: translateX(0);
    }
    to {
        opacity: 0;
        transform: translateX(2px);
    }
}
```

## Features

- ✅ Opens when the trigger is clicked.
- ✅ Closes when the trigger is clicked again or when pressing escape.
- ✅ Controllable from outside.

## Anatomy

```html
<ng-container rdxPopoverRoot>
    <button class="IconButton" rdxPopoverTrigger>+</button>

    <ng-template rdxPopoverContent [sideOffset]="8">
        <div class="PopoverContent" rdxPopoverContentAttributes>
            <button class="PopoverClose" rdxPopoverClose aria-label="Close">X</button>
            Add to library
            <div class="PopoverArrow" rdxPopoverArrow></div>
        </div>
    </ng-template>
</ng-container>
```

## Import

Get started with importing the directives:

```typescript
import {
  RdxPopoverRootDirective,
  RdxPopoverRootTrigger,
  RdxPopoverContentDirective,
  RdxPopoverArrowDirective,
  RdxPopoverCloseDirective
} from '@radix-ng/primitives/popover';
```

or

```typescript
import { RdxPopoverModule } from '@radix-ng/primitives/popover';
```

## API Reference

### Root
`RdxPopoverRootDirective`

Contains all the parts of a popover.

<ArgTypes of={RdxPopoverRootDirective} />

### Trigger
`RdxPopoverTriggerDirective`

The button that toggles the popover. By default, the PopoverContent will position itself against the trigger.

<Markdown>
    {`
   | Data attribute | Value
   | ----- | -----
   | [data-state] | <code>"closed" | "open" (type RdxPopoverState)</code>
   `}
</Markdown>

### Content
`RdxPopoverContentDirective`

The component that pops out when the popover is open.

<ArgTypes of={RdxPopoverContentDirective} />

<Markdown>
    {`
   | Data attribute | Value
   | ----- | -----
   | [data-state] | <code>"closed" | "open" (enum RdxPopoverState)</code>
   | [data-side] | <code>"left" | "right" | "bottom" | "top" (enum RdxPopoverSide)</code>
   | [data-align] | <code>"start" | "end" | "center" (enum RdxPopoverAlign)</code>
   `}
</Markdown>

### Arrow
`RdxPopoverArrowDirective`

An optional arrow element to render alongside the popover. This can be used to help visually link the trigger with the PopoverContent. Must be rendered inside PopoverContent.

<ArgTypes of={RdxPopoverArrowDirective} />

### Close
`RdxPopoverCloseDirective`

An optional close button element to render alongside the popover. This can be used to close the PopoverContent. Must be rendered inside PopoverContent.
