---
import path from 'path';
import { readFileSync } from 'fs';
import { Code } from 'astro-expressive-code/components';

export interface Props {
    name: string;
    file: string;
}
const { name, file } = Astro.props;


async function loadComponent(name: string, file: string) {
    const filename = path.join(
        process.cwd(),
        'src',
        'components',
        'demos',
        `${name}`,
        `${file}.ts`
    );

    const { default: Component } = await import(`./demos/${name}/${file}.ts`);

    const code = readFileSync(filename, 'utf-8')
        .toString()
        .replace(/export\s+default\s+.*;\s*/, '');

    return {
        Component,
        code
    };
}

const { Component, code } = await loadComponent(name, file);
---

<div class="relative text-[15px] text-black">
    <div
        class="vp-raw bg-gradient-to-br p-4 rounded-t-lg from-purple9 to-indigo9 w-full relative items-center justify-center flex">
        <div class="w-full max-w-[700px] flex items-center py-12 sm:py-[100px] justify-center ">
            <Component />
        </div>
    </div>
    <div id="Code">
        <Code code={code} lang="angular-ts" />
    </div>
</div>
