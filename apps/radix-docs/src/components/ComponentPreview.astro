---
import path from 'path';
import { readFileSync } from 'fs';
import { Code } from 'astro-expressive-code/components';
import { DemoLoaderComponent } from './demo-loader.component';

export interface Props {
    name: string;
    file: string;
}

const { name, file } = Astro.props;

async function loadCode(name: string, file: string) {
    const filename = path.join(process.cwd(), 'src', 'components', 'demos', `${name}`, `${file}.ts`);

    const code = readFileSync(filename, 'utf-8')
        .toString()
        .replace(/export\s+default\s+.*;\s*/, '');

    return {
        code
    };
}

const { code } = await loadCode(name, file);
---

<div class="relative -mx-11 text-[15px] text-black">
    <div
        class="vp-raw from-purple9 to-indigo9 relative flex w-full items-center justify-center rounded-t-lg bg-gradient-to-br p-4"
    >
        <div class="flex w-full max-w-[700px] items-center justify-center py-12 sm:py-[100px]">
            <DemoLoaderComponent name={name} file={file} client:only="angular" />
        </div>
    </div>
    <div id="Code">
        <Code code={code} lang="angular-ts" />
    </div>
</div>
